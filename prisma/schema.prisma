generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "windows"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model tbl_agendamento {
  id           Int           @id @default(autoincrement())
  status       String        @db.VarChar(50)
  data         DateTime      @db.Date
  hora         DateTime      @db.Time(0)
  id_usuario   Int?
  id_doacao    Int?
  id_hospital  Int?
  tbl_doacao   tbl_doacao?   @relation(fields: [id_doacao], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_agendamento_doacao")
  tbl_hospital tbl_hospital? @relation(fields: [id_hospital], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_agendamento_hospital")
  tbl_usuario  tbl_usuario?  @relation(fields: [id_usuario], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_agendamento_usuario")

  @@index([id_doacao], map: "FK_agendamento_doacao")
  @@index([id_hospital], map: "FK_agendamento_hospital")
  @@index([id_usuario], map: "FK_agendamento_usuario")
}

model tbl_banco_sangue {
  id             Int           @id @default(autoincrement())
  tipo_sanguineo String        @db.VarChar(5)
  quantidade     String        @db.VarChar(5)
  tbl_usuario    tbl_usuario[]
}

model tbl_certificado {
  id           Int      @id @default(autoincrement())
  titulo       String   @db.VarChar(50)
  organizacao  String   @db.VarChar(60)
  data_emissao DateTime @db.Date
}

model tbl_doacao {
  id              Int               @id @default(autoincrement())
  data            DateTime          @db.Date
  observacao      String?           @db.Text
  foto            String            @db.VarChar(255)
  tbl_agendamento tbl_agendamento[]
}

model tbl_hospital {
  id                 Int               @id @default(autoincrement())
  nome               String            @db.VarChar(70)
  email              String            @unique(map: "email") @db.VarChar(100)
  senha              String            @db.VarChar(20)
  cnpj               String            @unique(map: "cnpj") @db.VarChar(20)
  crm                String            @db.VarChar(255)
  cep                String            @db.VarChar(10)
  telefone           String            @db.VarChar(15)
  capacidade_maxima  Int               @default(10)
  convenios          String            @db.VarChar(255)
  horario_abertura   DateTime          @default(dbgenerated("'08:00:00'")) @db.Time(0)
  horario_fechamento DateTime          @default(dbgenerated("'18:00:00'")) @db.Time(0)
  foto               String            @db.VarChar(255)
  complemento        String?           @db.VarChar(255)
  tbl_agendamento    tbl_agendamento[]
}

model tbl_sexo {
  id          Int           @id @default(autoincrement())
  sexo        String        @db.VarChar(15)
  tbl_usuario tbl_usuario[]
}

model tbl_telefone {
  id     Int    @id @default(autoincrement())
  tipo   String @db.VarChar(30)
  numero String @db.VarChar(15)
}

model tbl_tipo_sanguineo {
  id   Int    @id @default(autoincrement())
  tipo String @unique(map: "tipo") @db.VarChar(5)
}

model tbl_usuario {
  id               Int               @id @default(autoincrement())
  nome             String            @db.VarChar(70)
  email            String            @unique(map: "email") @db.VarChar(100)
  senha_hash            String            @db.VarChar(255)
  cpf              String            @unique(map: "cpf") @db.VarChar(15)
  cep              String            @db.VarChar(10)
  logradouro       String?           @db.VarChar(150)
  bairro           String?           @db.VarChar(100)
  localidade       String?           @db.VarChar(100)
  uf               String?           @db.VarChar(2)
  numero           String?           @db.VarChar(20)
  tipo_sanguineo   String            @db.VarChar(5)
  data_nascimento  DateTime          @db.Date
  foto_perfil      String?           @db.VarChar(255)
  data_criacao     DateTime?         @default(now()) @db.Timestamp(0)
  data_atualizacao DateTime?         @default(now()) @db.Timestamp(0)
  id_banco_sangue  Int?
  id_sexo          Int?
  tbl_agendamento  tbl_agendamento[]
  tbl_banco_sangue tbl_banco_sangue? @relation(fields: [id_banco_sangue], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_usuario_banco_sangue")
  tbl_sexo         tbl_sexo?         @relation(fields: [id_sexo], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_usuario_sexo")

  @@index([id_banco_sangue], map: "FK_usuario_banco_sangue")
  @@index([id_sexo], map: "FK_usuario_sexo")
}
